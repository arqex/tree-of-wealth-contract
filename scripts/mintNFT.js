const { ethers } = require("hardhat");
// goerli:
// const CONTRACT_ADDRESS = '0x37d4B7268fD23248cC1849C8f3324fcDC5d18954';

// mumbai
// const CONTRACT_ADDRESS = '0x15243765e79b27F0Af10b0ee786330CD788B5AB9';

// mumbai 2 (encoding in the tokenURI method)
const CONTRACT_ADDRESS = '0x841df0FEf613d215d48F15687D5E45D533A8A983';
const AUCTION_ADDRESS = '0x293B2a3cE58bB8A448491223ae47532d0c05e921';

const svg = `
  <svg width="600" height="600" xmlns="http://www.w3.org/2000/svg"><path fill="#EEF" d="M0 0h600v600H0z"/><path d="M576 600c0-30-8.6-42.8-28.4-42.8-19.7 0-23 20.4-39 20.4s6.5-42.3-32.5-45c-39-2.7-18.6 50.7-43.3 38-55.3-28.3-38.2-91.3-6.6-59.6 6.6-62.2-93.8-25-46.7 12.7 4 24.2 9.5 29.4 31 54-88.6-35.4-110.5-108.4-67.8-97-5.8-36.6-49.5-22.5-30.4 36.7-44-36.4-72.4-81.4-105.4-81.4a34.8 34.8 0 0 0-35.9 35.8c0 17.7 19 34.3 26.4 8.9-16.6 5.4-16.6-18.2-7.4-18.2 14.4 0 11.6 29 42.2 29h.3c4.7-.3 17.2-3 17.2-15.8a1589 1589 0 0 1 49.6 54 172.8 172.8 0 0 0-40.4-6c-21.6 0-26.7 22.8-26.7 33.4 0 13.4 19.5 30.2 31.2 7-22.2-6-8.6-24.3 3.8-21.9 12.5 2.5 75 16.4 63.2 45h-18.1c-5.4 0 6.5-16.8-12.3-16.8-12.5 0-24.7 11-36.6 29.4H576ZM0 24c30 0 41.8 8.6 41.8 28.4 0 19.7-20.4 23-20.4 39s42.3-6.5 45 32.5c2.7 39-50.7 18.6-38 43.3 28.3 55.3 91.3 38.2 59.6 6.6 62.2-6.6 25 93.8-12.7 46.7-24.2-4-29.4-9.5-54-31 35.4 88.6 108.4 110.5 97 67.8 36.6 5.8 22.5 49.5-36.7 30.4 36.4 44 81.4 72.4 81.4 105.4a34.8 34.8 0 0 1-35.8 35.9c-17.7 0-34.3-19-8.9-26.4-5.4 16.6 18.2 16.6 18.2 7.4 0-14.4-29-11.6-29-42.2 0-4.4 2.8-17.5 15.8-17.5a1550 1550 0 0 0-54-49.6c4 16.4 6 29.9 6 40.4 0 21.6-22.8 26.7-33.4 26.7-13.4 0-30.2-19.5-7-31.2 6 22.2 24.3 8.6 21.9-3.8-11-50-26-71-45-63.2v18.1c0 5.4 16.8-6.5 16.8 12.3 0 12.5-10 24.7-28.4 36.6V24Z" fill="#FC4"/><path d="m600 .6-1 569a93.5 93.5 0 0 0-23-32.9c-12.4-10.2-57-4-164-79.7-143-14.3-156-56.3-180-57-16-.5-29.9 2.7-41.7 9.5 7.4-10.8 9.5-27 9.4-41-.2-25-42.8-37.9-57-180.8C66.9 80.7 73 36 62.9 23.7A92.4 92.4 0 0 0 31 1l-1-.4h570Z" fill="#D44"/><path d="M539 255c30 2 47 13 46 44-1 33-42 34-53 16-2.8-4.4-4-22 18-20-13-27-47 0-42 20l.3 1.1.2.8c3.3 12.3 14.5 40.5 71.5 28.2-2 8-22 30-55 18 2 24 30 32 60 19-1 5-14 26-47 21 9 19 35 16 55 1 0 7-7 12-7 20 0 17.7 12 37 13 40a1214 1214 0 0 0 0 48c-116.5-30.6-169.2-62-158-94 7-20 25-20 38-1 9-26 0-38-13-41 8.3-21 8-36.8-1-47-16 0-27.3 11.3-34 34-17.3-8.7-30.3-1-39 23 23-9 38.3-.3 24 23-18.8 30.7-115-1-174.7-51.7-51.8-61.5-82.4-155.4-51.4-174.4 23.3-14.3 32 1 23 24 24-8.7 31.7-21.7 23-39 22.7-6.7 34-18 34-34-16-14-27-6-47-1-3-13-15-22-41-13 19 13 19 31-1 38-32 11.2-63.4-41.5-94-158 15.7.3 31.7.3 48 0h.2l.2.2C139.4 1.9 158 13 175 13c8 0 13-7 20-7-15 20-18 46 1 55-5-33 16-46 21-47-13 30-5 58 19 60-12-33 10-53 18-55-13 60 19 69.2 30 72 20 5 47-29 20-42 2 22-15.5 20.8-20 18-18-11-17-52 16-53 31-1 42 16 44 46 1.6 24.3-9 36-24 55 20 5 44.4 8 59 33 10.8 18.5 6.5 45-7 57-25 22-76 6-52-32 8 19 25.7 13.3 29 10 17-17-3-52.3-34-35-25 14-30 52-6 74-23-8-46-8-58-3-17.7 7.4-23 23-15 35s23 3 18-14c18-10 25-3 46 0s27.8 1.9 40 0c-4.7 11.3-17.3 24-38 38 3.3-8.7 2-15.3-4-20-9-7-30 10-36 12l-15 5c5 13 20 15 28 15-15.8 14.9-14.3 37.3-9.4 43.5 6.2 5 28.6 6.4 43.5-9.4v.5c0 8 2.3 22.6 15 27.5l5-15c2-6 19-27 12-36-4.7-6-11.3-7.3-20-4l1-1.4c13.6-19.9 26-32 37-36.6-1.8 14-1.8 27.3 0 40s9.8 28.4 0 46c-17-5-26 10-14 18s27.6 2.7 35-15c5-12 5-35-3-58 22 24 60 19 74-6 17.3-30.9-18-51-35-34-3.3 3.3-9 21 10 29-38 24-54-27-32-52 11.9-13.5 38.5-17.8 57-7 26 15.2 31 36 33 59 19.5-13 33.4-25.4 55-24Z" fill="#FC4"/><path d="M585 194.7v44.6a248 248 0 0 1-147.7-59.2l31.6-31.6c32 26.4 72 43.3 116 46.2ZM403.9 13.6h-44.6a248 248 0 0 0 59.2 147.7l31.6-31.6a203.6 203.6 0 0 1-46.2-116Z" fill="#FC4"/><path d="M600 0v175c-93 0-175-65.5-175-175h175Z" fill="#EEF"/><path d="M600 0v145c-77 0-145-54.3-145-145h145Z" fill="#3A5"/><path d="M600 0v115c-15.9-5.3-24.2-13-25-23.6V91c-.7-10.7 4.3-16 15-16l1-27c-6 1-15-3-20-7-8 7.5-14 13.8-18 19 6 5 9 14 0 23-4 4-17.6 5.6-41 5-.5-23.4 1-37 5-41 9-9 18-6 23 0 7.8-6.4 14-12.4 19-18-4-5-8-14-7-20-8 0-17 .4-27 1 0 10.7-5.3 15.7-16 15-10.7-.6-18.7-9-24-25h115Z" fill="#EEF"/><path fill="#D44" d="M243.6 599.4H1l-.4.4v-243z"/><path fill="#FC4" d="m127.6 539.4-22 22 21 20 20-21 21 21L149 600l-148-.6-.4.4v-.4L0 451l18.6-18.2 21 21-21 20 20 21 22-22 22 22-22 22 23 22.6 22-22z"/><path d="M126 600H0V474a87 87 0 0 1 21.3 55.6l-11.7.2-1 35c4 5.3 8.3 5.6 13 1 7-7 2-18 15-30 8.5-7.8 18-8.3 27 .6 9 9 9 18.4 1 27-12 13-23 8-30 15-4.7 4.7-4.4 9 1 13l35-1v-12A85 85 0 0 1 126 600Z" fill="#3A5"/></svg>
`;

const metadata = {
  name: "alfa",
  description: "This is the first tile",
  attributes: [
    {trait_type: "Mosaic size", value: 4},
    {trait_type: "Mosaic method", value: "Rotation"},
    {trait_type: "Name type", value: "Letters"}
  ]
}


async function main() {
  const [deployer] = await ethers.getSigners();

  const Monsaic = await ethers.getContractFactory("Monsaic");
  const monsaic = new ethers.Contract(CONTRACT_ADDRESS, Monsaic.interface, deployer);

  const nftId = await monsaic.mintNFT( calculateTokenURI(svg, metadata) );
  
  console.log( 'NFT minted!', nftId );
}


main()
  .then(() => process.exit(0))
  .catch((error) => {
    console.error(error)
    process.exit(1)
  })



function calculateTokenURI( svg, metadata ){
  let safeSVG = svg.trim().replaceAll(/>\s+</g, '');
  let content = {...metadata, image: 'data:image/svg+xml,' + safeSVG};
  
  return JSON.stringify(content);
}